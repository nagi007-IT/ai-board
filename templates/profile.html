{% extends "base.html" %}
{% block title %}{{ username }} さんのプロフィール{% endblock %}

{% block content %}
<div class="py-4">
  <h2 class="mb-4">{{ username }} さんの投稿履歴</h2>

  {% if posts and posts|length > 0 %}
    <div class="row row-cols-1 row-cols-md-2 g-4">
      {% for post in posts %}
        <div class="col">
          <div class="card shadow-sm h-100">
            <div class="card-body">
              <h5 class="card-title mb-2">
                <a href="{{ url_for('post_detail', post_id=post[0]) }}">{{ post[2] }}</a>
              </h5>

              {% if post|length > 8 and post[8] %}
                <div class="mb-2">
                  <img src="{{ post[8] }}" alt="関連画像" class="img-fluid rounded" style="max-height:140px; object-fit:cover;">
                </div>
              {% endif %}

              <p class="mb-1"><strong>ジャンル:</strong> {{ post[1] }}</p>
              <p class="mb-2"><strong>活用内容:</strong> {{ post[3] }}</p>

              <p class="text-muted small mb-0">
                <strong>投稿日時:</strong> {{ post[9] | datetime_jp }}
                {% if post|length > 10 and post[10] %}
                  / <strong>最終更新:</strong> {{ post[10] | datetime_jp }}
                {% endif %}
              </p>

              {% if current_user.is_authenticated and current_user.username == username %}
                <div class="mt-3">
                  <a href="{{ url_for('edit_post', post_id=post[0]) }}" class="btn btn-sm btn-outline-primary">編集</a>
                </div>
              {% endif %}
            </div>
          </div>
        </div>
      {% endfor %}
    </div>
  {% else %}
    <p class="text-muted">このユーザーの投稿はまだありません。</p>
  {% endif %}

  <a href="{{ url_for('show_posts') }}" class="btn btn-outline-secondary mt-4">← 投稿一覧に戻る</a>
</div>
{% endblock %}
